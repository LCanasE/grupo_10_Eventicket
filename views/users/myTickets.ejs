<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('../partials/head') %>
</head>
<body>
  <header>
    <%- include('../partials/header') %>
  </header>
  <main class="main-registro">
    <section class="mi-perfil">
      <h2 style="text-align: center; color: #313d55;">Mis Tickets</h2>

       
            <h4 class="datos-mi-perfil">Tickets Comprados</h4>
              <div class="eventos-mis-tickets">
                  <% if (user.products && user.products.length > 0) { %>
                    
                    <ul class="eventos-mi-perfil-ul">
                      <% user.products.forEach(product => { %>
                        
                        <a class="eventos-mi-perfil-a" href="/products/<%= product.id %>/eventsDetails">
                          <li class="eventos-mis-tickets-li">
                            <img src="<%= product.image %>" alt="<%= product.name %>"><h4 style="color: #313d55;"><%= product.name %> en <%= product.location %> | <%= formateDate(product.date) %></h4>
                            
                          </li>
                        </a>
                        <button class="generar-qr-btn" data-product-name="<%= product.name %>" data-product-location="<%= product.location %>" data-product-image="<%= product.image %>">
                          Ver Entrada QR
                        </button>
                      <% }); %>
                      
                       </ul>
                      <% } else { %>
                         <h4 style="color: #313d55;">Aún no tienes eventos creados.</h4>
                        <% } %>
                  </div>          
              </div>
    </section>
  </main>
  <footer>
    <%- include('../partials/footer') %>
  </footer>

  <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>

<script>
  const generarQRButtons = document.querySelectorAll(".generar-qr-btn");

  generarQRButtons.forEach(button => {
    button.addEventListener("click", function () {
      const productName = this.getAttribute("data-product-name");
      const productLocation = this.getAttribute("data-product-location");
      const productImage = this.getAttribute("data-product-image")
      // Crear una cadena con la información del producto
      const productInfo = `${productName} en ${productLocation}`;

      // Generar el código QR y agregarlo a un elemento HTML
      const qrCodeContainer = document.createElement("div");
      new QRCode(qrCodeContainer, productInfo);

      // Mostrar el código QR en un cuadro de diálogo o modal
      Swal.fire({
        title: `${productName} en ${productLocation}`,
        html: qrCodeContainer,
/*         showCancelButton: true, */
        confirmButtonText: "Aceptar",
      });
    });
  });
</script>


</body>

</html>